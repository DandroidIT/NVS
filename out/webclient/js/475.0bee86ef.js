"use strict";(self["webpackChunknvs_c"]=self["webpackChunknvs_c"]||[]).push([[475],{8707:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(2775),i=a(1585);class l{getCams(){return new Promise((e=>{const t=t=>{e(t)};i.Z.bindAndsend({name:s.N.Cam_List,cb:t})}))}_objMove(e,t,a=100,i="0"){if("STOP"===t)return JSON.stringify({type:s.N.Cam_Controll,payload:{tagcam:e,cmd:"move_stop"}});const l={tagcam:e,speed:{x:"",y:"",z:""},timeout:a,cmd:"move",preset:i},o=l;return"UP"===t?o.speed={x:"0",y:"1.0",z:"0"}:"UPLEFT"===t?o.speed={x:"-1.0",y:"1.0",z:"0"}:"UPRIGHT"===t?o.speed={x:"1.0",y:"1.0",z:"0"}:"DOWN"===t?o.speed={x:"0",y:"-1.0",z:"0"}:"DOWNLEFT"===t?o.speed={x:"-1.0",y:"-1.0",z:"0"}:"DOWNRIGHT"===t?o.speed={x:"1.0",y:"-1.0",z:"0"}:"LEFT"===t?o.speed={x:"-1.0",y:"0",z:"0"}:"RIGHT"===t?o.speed={x:"1.0",y:"0",z:"0"}:"ZOOMIN"===t?o.speed={x:"0",y:"0",z:"1.0"}:"ZOOMOUT"===t?o.speed={x:"0",y:"0",z:"-1.0"}:"preset"!==t&&"save_preset"!==t||(o.speed={x:"1",y:"1",z:"1"},o.cmd=t),JSON.stringify({type:s.N.Cam_Controll,payload:o})}move(e,t,a="1",l=100){return new Promise((o=>{const n=e=>{o(e)};i.Z.bindAndsend({name:s.N.Cam_Controll,cb:n},{name:s.N.Cam_Controll,msg:this._objMove(e,t,l,a)})}))}screenshot(e){return new Promise((t=>{const a=e=>{t(e)},l=JSON.stringify({payload:{tagcam:e}});i.Z.bindAndsend({name:s.N.Cam_Screenshot,cb:a},{msg:l})}))}setOptionCam(e,t,a,l=!1){return new Promise((o=>{const n=JSON.stringify({payload:{tagcam:e,option:t,data:a,checkonly:l}});i.Z.bindAndsend({name:s.N.Cam_Setoption,cb:e=>{o(e)}},{msg:n})}))}probeCams(){return new Promise((e=>{const t=t=>{e(t)};i.Z.bindAndsend({name:s.N.radarCams,cb:t})}))}saveProbeCam(e){return new Promise((t=>{const a=JSON.stringify({payload:{cam:e}}),l=e=>{t(e)};i.Z.bindAndsend({name:s.N.saveRadarCam,cb:l},{msg:a})}))}}const o=new l},658:(e,t,a)=>{a.d(t,{Z:()=>u});var s=a(1959),i=a(8707),l=a(5267),o=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function o(e){try{r(s.next(e))}catch(t){l(t)}}function n(e){try{r(s["throw"](e))}catch(t){l(t)}}function r(e){e.done?a(e.value):i(e.value).then(o,n)}r((s=s.apply(e,t||[])).next())}))};const n=a(4244).lW,r=(0,s.qj)({}),d=(0,s.qj)({success:!0,msgError:"",msgSuccess:""}),c=(0,s.qj)([]),m=()=>{const e=e=>`${l.u.wss}/stream/${e}`,t=(e=!1)=>o(void 0,void 0,void 0,(function*(){var t;if(e&&(r.list=[]),null===(t=r.list)||void 0===t?void 0:t.length)return;const a=yield i.Z.getCams();!1===a.inError?r.list=a.dataResult:d.msgError=a.msg,d.success=!a.inError})),a=e=>o(void 0,void 0,void 0,(function*(){var a;void 0===r.list&&(yield t(!0));const s=null===(a=r.list)||void 0===a?void 0:a.find((t=>(null===t||void 0===t?void 0:t.id)==e));if(s)return s})),m=e=>o(void 0,void 0,void 0,(function*(){yield u(e,"delete",!0),d.success&&(yield t(!0))})),u=(e,t,s,l=!1)=>o(void 0,void 0,void 0,(function*(){const o=yield i.Z.setOptionCam(e,t,s,l);!0===o.inError&&(d.msgError=o.msg),d.success=!o.inError;const n=yield a(e);n&&("live24"===t?n.liveH24=o.dataResult:"livemotion"===t&&(n.motion=o.dataResult))})),p=e=>o(void 0,void 0,void 0,(function*(){const t=yield i.Z.screenshot(e);if(!1===t.inError){const e=`data:image/jpg;base64, ${n.from(t.dataResult.data).toString("base64")}`;c.push(e)}else d.msgError=t.msg;d.success=!t.inError})),v=(e,t,a)=>o(void 0,void 0,void 0,(function*(){const s=yield i.Z.move(e,t,a);s.inError&&(d.msgError=s.msg),d.success=s.dataResult}));return{state:d,cams:(0,s.OT)(r),screenshots:c,urlplayer:e,getCam:a,getCams:t,deleteCam:m,getScreenshot:p,panMove:v,setOptions:u}},u=m},2587:(e,t,a)=>{a.d(t,{Z:()=>f});var s=a(1959),i=a(3457),l=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function o(e){try{r(s.next(e))}catch(t){l(t)}}function n(e){try{r(s["throw"](e))}catch(t){l(t)}}function r(e){e.done?a(e.value):i(e.value).then(o,n)}r((s=s.apply(e,t||[])).next())}))};const o=(0,s.qj)({success:!0,msgError:"",msgSuccess:""}),n=(0,s.qj)([]),r=(0,s.iH)([""]),d=(0,s.qj)([]),c=(e,t,a)=>l(void 0,void 0,void 0,(function*(){const s=yield i.Z.setOptions(e,t,a);return s})),m=(e=!1)=>l(void 0,void 0,void 0,(function*(){const t=yield c("ipblock","",e);return o.success=t.dataResult,o.success||(o.msgError="error get Ip Block"),o.success})),u=(e="",t={start:"",end:""})=>l(void 0,void 0,void 0,(function*(){const a=yield i.Z.AlarmsCount(e,t);a.inError||(n.splice(0,n.length),r.value=[],a.dataResult.map((e=>{n.push(e),r.value.push(e.stamptime.split("T")[0].split("-").join("/"))})))})),p=(e="",t={start:"",end:""})=>l(void 0,void 0,void 0,(function*(){const a=yield i.Z.AlarmsDet(e,t);a.inError||(d.splice(0,d.length),a.dataResult.map((e=>{d.push(e)})))})),v=e=>l(void 0,void 0,void 0,(function*(){const t=yield i.Z.AlarmDet(e);if(!t.inError)return t.dataResult})),g=()=>({state:o,listDateAlarms:n,listAlarmsDet:d,listDateAlarmsString:r,getAlarmsCount:u,getAlarmsDet:p,getAlarmDet:v,checkIpPublicBlock:m}),f=g},2391:(e,t,a)=>{a.d(t,{_:()=>l,K:()=>o});var s=a(4434),i=a(5616);const l=(e,t=1500)=>{e&&s.Z.create({icon:"mdi-information-variant",progress:!0,message:e,position:"top",timeout:t,textColor:"white",color:"",actions:[{icon:"close",color:"white"}]})},o=(e,t,a)=>{const s=new Date(e,t-1,a);return i.ZP.daysInMonth(s)}},9475:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ie});a(7280);var s=a(3673),i=a(2323),l=a(8880);const o={class:"row"},n={class:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},r={class:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},d={class:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},c=(0,s.Uk)("Minimize"),m=(0,s.Uk)("Maximize"),u=(0,s.Uk)("Close"),p={class:"row"},v={class:"col-xs-3"},g={class:"col-xs-6"},f={class:"text-h6"},w={class:"col-xs-3"},y={class:"row q-col-gutter-sm q-py-sm"};function h(e,t,a,h,x,D){const b=(0,s.up)("q-spinner-puff"),W=(0,s.up)("q-dialog"),C=(0,s.up)("q-btn-toggle"),Z=(0,s.up)("q-date"),_=(0,s.up)("q-icon"),A=(0,s.up)("q-toolbar-title"),z=(0,s.up)("q-space"),k=(0,s.up)("q-toolbar"),q=(0,s.up)("q-item-section"),T=(0,s.up)("q-item"),S=(0,s.up)("q-separator"),E=(0,s.up)("q-virtual-scroll"),O=(0,s.up)("q-tooltip"),P=(0,s.up)("q-btn"),Q=(0,s.up)("q-bar"),N=(0,s.up)("q-item-label"),j=(0,s.up)("q-card-section"),I=(0,s.up)("q-card"),U=(0,s.up)("q-page"),V=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(U,{class:"bg-primary q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{modelValue:e.state.isawait,"onUpdate:modelValue":t[1]||(t[1]=t=>e.state.isawait=t),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{color:"red",size:"20em"})])),_:1},8,["modelValue"]),(0,s.Wm)(I,{dark:"",class:"bg-transparent no-shadow no-border"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",o,[(0,s.Wm)("div",n,[(0,s.Wm)(C,{modelValue:e.selectCam,"onUpdate:modelValue":t[2]||(t[2]=t=>e.selectCam=t),spread:"","no-caps":"","toggle-color":"orange",color:"white","text-color":"black",options:e.listCams},null,8,["modelValue","options"])]),(0,s.Wm)("div",r,[(0,s.Wm)(Z,{class:"full-width full-height","today-btn":"",minimal:"","event-color":"red",modelValue:e.selectDay,"onUpdate:modelValue":[t[3]||(t[3]=t=>e.selectDay=t),e.clickDay],events:e.listDateAlarmsString,"emit-immediately":!0,dark:"",color:"orange",mask:"YYYY-MM-DD"},null,8,["modelValue","events","onUpdate:modelValue"])]),(0,s.Wm)("div",d,[(0,s.wy)((0,s.Wm)(k,{class:"bg-primary text-white shadow-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(A,{class:"text-caption"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{name:"mdi-clipboard-list-outline",color:"orange"}),(0,s.Uk)(" Items n. "+(0,i.zw)(e.AlarmsDetlist.length),1)])),_:1}),(0,s.Wm)(z),(0,s.Wm)(A,{class:"text-caption text-right"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{name:"mdi-calendar",color:"orange"}),(0,s.Uk)(" "+(0,i.zw)(e.selectDay),1)])),_:1})])),_:1},512),[[l.F8,e.AlarmsDetlist.length>0]]),(0,s.Wm)(E,{style:{"max-height":"600px"},items:e.AlarmsDetlist,separator:""},{default:(0,s.w5)((({item:t,index:a})=>[(0,s.Wm)(T,{key:a,clickable:"",onClick:a=>e.viewDet(t.id)},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{name:"mdi-alarm-check",color:"orange",style:{"font-size":"1.9rem"}})])),_:1}),(0,s.Wm)(q,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t.namecam)+" "+(0,i.zw)(e.helpers.dataIsoTo(t.stamptime,"time")),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,s.Wm)(S,{spaced:"",inset:"item"})])),_:1},8,["items"]),(0,s.Wm)(W,{modelValue:e.openDialog,"onUpdate:modelValue":t[8]||(t[8]=t=>e.openDialog=t),maximized:e.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{class:"bg-primary text-white"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(z),(0,s.Wm)(P,{dense:"",flat:"",icon:"minimize",onClick:t[4]||(t[4]=t=>e.maximizedToggle=!1),disable:!e.maximizedToggle},{default:(0,s.w5)((()=>[e.maximizedToggle?((0,s.wg)(),(0,s.j4)(O,{key:0,class:"bg-white text-primary"},{default:(0,s.w5)((()=>[c])),_:1})):(0,s.kq)("",!0)])),_:1},8,["disable"]),(0,s.Wm)(P,{dense:"",flat:"",icon:"crop_square",onClick:t[5]||(t[5]=t=>e.maximizedToggle=!0),disable:e.maximizedToggle},{default:(0,s.w5)((()=>[e.maximizedToggle?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(O,{key:0,class:"bg-white text-primary"},{default:(0,s.w5)((()=>[m])),_:1}))])),_:1},8,["disable"]),(0,s.wy)((0,s.Wm)(P,{dense:"",flat:"",icon:"close"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[u])),_:1})])),_:1},512),[[V]])])),_:1}),(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",p,[(0,s.Wm)("div",v,[(0,s.Wm)(P,{label:"prev",icon:"mdi-arrow-left-bold",color:"orange",flat:"",size:"xl",padding:"xs",class:"float-left full-width text-capitalize",onMousedown:t[6]||(t[6]=t=>e.navigateAlarms("left"))})]),(0,s.Wm)("div",g,[(0,s.Wm)(T,{class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{class:"text-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",f,(0,i.zw)(e.alarmDet.namecam),1)])),_:1}),(0,s.Wm)(N,{caption:"",class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.alarmDet.stamptime),1)])),_:1})])),_:1})])),_:1})]),(0,s.Wm)("div",w,[(0,s.Wm)(P,{label:"next","icon-right":"mdi-arrow-right-bold",color:"orange",flat:"",size:"xl",padding:"xs",class:"float-right full-width text-capitalize",onMousedown:t[7]||(t[7]=t=>e.navigateAlarms("right"))})])])])),_:1}),(0,s.Wm)(j,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",y,[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(e.alarmDet.datarif.split("|"),((e,t)=>((0,s.wg)(),(0,s.j4)("div",{class:"col-lg-6 col-md-6 col-sm-12 col-xs-12",key:t},[(0,s.Wm)("img",{class:"full-width",src:e},null,8,["src"])])))),128))])])),_:1})])),_:1})])),_:1},8,["modelValue","maximized"])])])])),_:1})])),_:1})}var x=a(1959),D=a(2587),b=a(658);class W{static dataIsoTo(e,t){return"data"===t?e.split("T")[0]:"time"===t?e.split("T")[1].replace("Z",""):"data&time"===t?`${e.split("T")[0]} ${e.split("T")[1].replace("Z","")}`:""}static waitFor(e){return new Promise((t=>setTimeout(t,e)))}}var C=a(2391),Z=function(e,t,a,s){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function o(e){try{r(s.next(e))}catch(t){l(t)}}function n(e){try{r(s["throw"](e))}catch(t){l(t)}}function r(e){e.done?a(e.value):i(e.value).then(o,n)}r((s=s.apply(e,t||[])).next())}))};const{listDateAlarms:_,listDateAlarmsString:A,listAlarmsDet:z,getAlarmsCount:k,getAlarmsDet:q,getAlarmDet:T}=(0,D.Z)(),{cams:S}=(0,b.Z)(),E=()=>{const e=(0,x.qj)({isawait:!1,success:!0,msgError:"",msgSuccess:""}),t=(0,x.qj)([{label:"All",value:""}]),a=(0,x.iH)(""),i=(0,x.iH)(""),l=(0,x.iH)(),o=(0,x.iH)(!1),n={start:"",end:""},r=[];(0,s.YP)(i,(()=>Z(void 0,void 0,void 0,(function*(){yield k(i.value,n),yield q(i.value,{start:a.value,end:""})})))),(0,s.bv)((()=>Z(void 0,void 0,void 0,(function*(){var e;a.value=(new Date).toISOString().split("T")[0],null===(e=S.list)||void 0===e||e.map((e=>{t.push({label:e.name,value:e.id})})),yield k(),n.start=(new Date).toISOString().split("T")[0],yield q(i.value,n)}))));const d=(t,s,l)=>Z(void 0,void 0,void 0,(function*(){if("add-day"===s)e.isawait=!0,n.start=t,yield q(i.value,n),e.isawait=!1;else if("remove-day"===s)z.splice(0,z.length);else if("month"===s||"year"===s){const e=(0,C.K)(l.year,l.month,l.day);n.start=`${t.split("-")[0]}-${t.split("-")[1]}-01`,n.end=`${t.split("-")[0]}-${t.split("-")[1]}-${e}`,yield k(i.value,n),yield q(i.value,{start:a.value,end:""})}})),c=t=>Z(void 0,void 0,void 0,(function*(){e.isawait=!0,l.value=yield T(t),l.value&&(l.value.stamptime=W.dataIsoTo(l.value.stamptime,"data&time"),m(),o.value=!0),e.isawait=!1})),m=()=>{r.splice(0,r.length),null===z||void 0===z||z.map(((e,t)=>{var a;e.id===(null===(a=l.value)||void 0===a?void 0:a.id)&&(r.push(z[t-1]?z[t-1].id:"end"),r.push(z[t+1]?z[t+1].id:"end"))}))},u=e=>Z(void 0,void 0,void 0,(function*(){const t="left"===e?r[0]:r[1];Number(t)?yield c(t):o.value=!1}));return{state:e,openDialog:o,selectDay:a,selectCam:i,listCams:t,alarmDet:l,AlarmsDetlist:z,navigateAlarms:u,viewDet:c,listDateAlarms:_,listDateAlarmsString:A,clickDay:d}},O=E,P=(0,s.aZ)({name:"pCalendarAlarms",setup(){const{openDialog:e,alarmDet:t,state:a,selectDay:s,selectCam:i,listCams:l,clickDay:o,viewDet:n,navigateAlarms:r,listDateAlarmsString:d,AlarmsDetlist:c}=O();return{navigateAlarms:r,alarmDet:t,openDialog:e,maximizedToggle:(0,x.iH)(!0),AlarmsDetlist:c,viewDet:n,helpers:W,state:a,listCams:l,selectCam:i,listDateAlarmsString:d,selectDay:s,clickDay:o}}});var Q=a(4379),N=a(6778),j=a(8430),I=a(151),U=a(8761),V=a(6915),R=a(9570),M=a(3747),H=a(4554),$=a(2025),Y=a(7369),B=a(3414),F=a(2035),J=a(5869),L=a(846),G=a(4607),K=a(8870),X=a(5589),ee=a(2350),te=a(677),ae=a(7518),se=a.n(ae);P.render=h;const ie=P;se()(P,"components",{QPage:Q.Z,QDialog:N.Z,QSpinnerPuff:j.Z,QCard:I.Z,QBtnToggle:U.Z,QDate:V.Z,QToolbar:R.Z,QToolbarTitle:M.Z,QIcon:H.Z,QSpace:$.Z,QVirtualScroll:Y.Z,QItem:B.Z,QItemSection:F.Z,QSeparator:J.Z,QBar:L.Z,QBtn:G.Z,QTooltip:K.Z,QCardSection:X.Z,QItemLabel:ee.Z}),se()(P,"directives",{ClosePopup:te.Z})}}]);